<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ø¯Ø±Ø³Ø© Ø¹Ù…Ø±</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body {
    font-family: "Cairo", sans-serif;
    background: linear-gradient(135deg, #396afc, #2948ff);
    margin: 0;
    padding: 0;
    color: white;
    text-align: center;
}
.container {
    margin: 40px auto;
    background: white;
    color: #333;
    width: 90%;
    max-width: 500px;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}
input {
    width: 90%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #aaa;
    margin-bottom: 10px;
    font-size: 16px;
}
button {
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    background: #396afc;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: .2s;
}
button:hover { background: #2948ff; }
#studentList div {
    background: #f4f6ff;
    padding: 10px;
    margin: 6px 0;
    border-radius: 8px;
    border-right: 5px solid #2948ff;
    font-weight: bold;
}
#adminPanel { display: none; opacity:0; transform:translateY(20px); transition:.4s;}
#adminPanel.show { display:block; opacity:1; transform:translateY(0);}
.editBox { display:flex; gap:5px; margin-bottom:8px; }
.editBox input { flex:1; }
</style>
</head>
<body>

<h1>ğŸ“˜ Ù…Ø¯Ø±Ø³Ø© Ø¹Ù…Ø±</h1>

<div class="container">
    <h2>ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
    <input id="studentName" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§">
    <button onclick="addStudent()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø³Ù…</button>
    <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†: <span id="count">0</span></h3>
    <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡</h3>
    <div id="studentList"></div>

    <div id="adminPanel">
        <hr>
        <h2>âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
        <button onclick="exportExcel()">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø¥Ù„Ù‰ Excel (XLSX)</button>
        <h3>ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø³Ù…Ø§Ø¡:</h3>
        <div id="adminList"></div>
        <hr>
        <h3>ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
        <input id="newPass" type="text" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
        <button onclick="changePassword()">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>
    </div>
</div>

<script>
// Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø³Ø±ÙŠ
const ADMIN_KEY = "K1408k@ksa";

// ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ø®Ø²Ù†Ø© ÙÙŠ LocalStorage
let adminPass = localStorage.getItem("adminPass") || "K1408k@ksa";

let students = JSON.parse(localStorage.getItem("students")) || [];

// Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø§Ø¨
function save() { localStorage.setItem("students", JSON.stringify(students)); }

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
function updateCount() { document.getElementById("count").textContent = students.length; }

// Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø§Ø¨
function displayStudents() {
    let list = document.getElementById("studentList");
    list.innerHTML = "";
    students.forEach(s => {
        list.innerHTML += `<div>${s.name}<br><small>â± ${s.time}</small></div>`;
    });
    updateCount();
}

// Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
function displayAdminList() {
    let list = document.getElementById("adminList");
    list.innerHTML = "";
    students.forEach((s,i)=>{
        list.innerHTML += `<div class="editBox">
            <input id="edit_${i}" value="${s.name}">
            <button onclick="editStudent(${i})">ØªØ¹Ø¯ÙŠÙ„</button>
            <button onclick="deleteStudent(${i})" style="background:red">Ø­Ø°Ù</button>
        </div>`;
    });
}

// Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨
function addStudent(){
    let name=document.getElementById("studentName").value.trim();
    if(!name){alert("ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù….");return;}
    let now=new Date().toLocaleString("ar-SA");
    students.push({name,time:now});
    save();
    displayStudents();
    document.getElementById("studentName").value="";
}

// ØªØ¹Ø¯ÙŠÙ„
function editStudent(i){
    let newName=document.getElementById("edit_"+i).value.trim();
    if(!newName){alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ±Ùƒ Ø§Ù„Ø§Ø³Ù… ÙØ§Ø±Øº"); return;}
    students[i].name=newName;
    save();
    displayStudents();
    displayAdminList();
}

// Ø­Ø°Ù
function deleteStudent(i){
    if(!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù…ØŸ")) return;
    students.splice(i,1);
    save();
    displayStudents();
    displayAdminList();
}

// ØªØµØ¯ÙŠØ± Excel
function exportExcel(){
    let data = students.map((s,index)=>({ "Ø§Ù„Ø±Ù‚Ù…":index+1, "Ø§Ù„Ø§Ø³Ù…":s.name, "ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„":s.time }));
    let ws = XLSX.utils.json_to_sheet(data);
    let wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ø·Ù„Ø§Ø¨");
    XLSX.writeFile(wb, "Ø§Ø³Ù…Ø§Ø¡_Ù…Ø¯Ø±Ø³Ø©_Ø¹Ù…Ø±.xlsx");
}

// ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
function changePassword(){
    let newP = document.getElementById("newPass").value.trim();
    if(!newP){ alert("Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"); return; }
    adminPass=newP;
    localStorage.setItem("adminPass",adminPass);
    alert("âœ… ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!");
    document.getElementById("newPass").value="";
}

// ØªØ­Ù‚Ù‚ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø³Ø±ÙŠ ÙˆØ§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
let urlParams = new URLSearchParams(window.location.search);
if(urlParams.get("adminKey")===ADMIN_KEY){
    let pass=prompt("ğŸ” Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø£Ø¯Ù…Ù†:");
    if(pass===adminPass){
        let panel=document.getElementById("adminPanel");
        panel.classList.add("show");
        displayAdminList();
    } else { alert("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!"); }
}

// ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
displayStudents();

</script>

</body>
</html>
